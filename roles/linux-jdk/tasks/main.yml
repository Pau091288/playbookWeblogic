---
# ==> Create user and groups
- name: Create groups
  group: name={{ oracle_group }} state=present

- name: Create user
  user: name={{ oracle_user }} groups={{ oracle_group }} 
  #password={{ oracle_os_user_pass }}

- name: Crear jdk_folder
  file: state=directory path={{ jdk_folder }} owner={{ oracle_user }} group={{ oracle_group }} 

- name: Change ownership of jdk folder
  file: path="{{ jdk_folder }}" owner={{ oracle_user }} group={{ oracle_group }} recurse=yes
 
- name: Download jdk linux
  become: true
  get_url: url="https://{{ server }}/s/CSj9zrCdxEPoCec/download/jdk-19_linux-x64_bin.rpm" dest="/{{ jdk_folder }}/jdk-19_linux-x64_bin.rpm" owner=root group=root
  #when: ansible_os_family == "Linux"
  tags: descarga

- name: Install with rpm
  become: true
  yum:
    name: /{{ jdk_folder }}/jdk-19_linux-x64_bin.rpm
    state: present

- name: Download jdk linux
  become: true
  get_url: 
    url="https://download.oracle.com/java/19/latest/jdk-19_linux-x64_bin.rpm"
    headers="Cookie:oraclelicense=accept-securebackup-cookie"
    dest="/opt/jdk-19_linux-x64_bin.rpm" owner=root group=root
  when: ansible_os_family == "Linux"
  tags: descarga
  
- name: Download jdk windows
  win_get_url:
    url: https://download.oracle.com/java/19/latest/jdk-19_windows-x64_bin.msi
    dest: C:\weblogic-dependencies
    validate_certs: no
  #when: java_version['failed'] == true
  when: ansible_os_family == "Windows"

- name: Install weblogic windows
  shell: "msi path_jdk"


- name: Uninstall jdk
  shell: rpm -e jdk-19_linux-x64_bin.rpm
  tags: uninstall